services:
    signature.security.authentication.provider:
        class: Telepay\FinancialApiBundle\Security\Authentication\Provider\SignatureAuthenticationProvider
        arguments: ["", "%kernel.cache_dir%/security/nonces"]

    signature.security.authentication.listener:
        class: Telepay\FinancialApiBundle\Security\Firewall\SignatureListener
        arguments: ["@security.context", "@security.authentication.manager"]

    access_key.security.user_provider:
        class: Telepay\FinancialApiBundle\Security\AccessKeyUserProvider
        arguments: ["@fos_user.user_manager"]

    transaction.context:
        class: Telepay\FinancialApiBundle\DependencyInjection\Transactions\Core\TransactionContext
        arguments:
            - "@service_container"
        #arguments: ["@request_stack", "@security.context", "@doctrine_mongodb", "@doctrine"]

    notificator:
        class: Telepay\FinancialApiBundle\DependencyInjection\Transactions\Core\Notificator
        arguments:
            - "@service_container"
        #arguments: ["@request_stack", "@security.context", "@doctrine_mongodb", "@doctrine"]

    security.authentication.switchuser_listener:
        class: Telepay\FinancialApiBundle\Security\Firewall\SwitchUserListener
        public: false
        abstract: true
        tags:
            - { name: monolog.logger, channel: security }
        arguments:
           - @security.context
           - null
           - @security.user_checker
           - null
           - @security.access.decision_manager
           - @logger
           - su
           - ROLE_ALLOWED_TO_SWITCH
           - @event_dispatcher

