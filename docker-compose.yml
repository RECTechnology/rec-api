version: '3'

volumes:
  rdb:
  nrdb:
  blockchain:
  logs:

services:
  api:
    user: ${UID:-1000}:${UID:-1000}
    build:
      context: .
      dockerfile: Dockerfile.dev
    environment:
      - APP_API_DOMAIN=http://localhost:8000
    volumes:
      - ./:/api
    ports:
      - 8000:8000

  rdb:
    image: mariadb
    environment:
      - MYSQL_DATABASE=api
      - MYSQL_USER=api
      - MYSQL_PASSWORD=api
      - MYSQL_ALLOW_EMPTY_PASSWORD=yes
    ports:
      - 3307:3306

  rdbadmin:
    image: phpmyadmin/phpmyadmin
    environment:
      - PMA_HOST=rdb
      - PMA_port=3306
    ports:
      - 8080:80

  nrdb:
    image: mongo
    environment:
      - MONGO_INITDB_ROOT_USERNAME=api
      - MONGO_INITDB_ROOT_PASSWORD=api

  nrdbadmin:
    image: mongo-express
    ports:
      - 8081:8081
    environment:
      - ME_CONFIG_MONGODB_ADMINUSERNAME=api
      - ME_CONFIG_MONGODB_ADMINPASSWORD=api
      - ME_CONFIG_MONGODB_SERVER=nrdb
    depends_on:
      - nrdb

  node:
    image: qbitartifacts/crea-node
    volumes:
      - blockchain:/root/.creativecoin
