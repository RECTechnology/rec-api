version: '3'

volumes:
  rdb:
  nrdb:
  blockchain:
  logs:

services:
  api:
    user: ${UID:-1000}:${UID:-1000}
    build:
      context: .
      dockerfile: Dockerfile.dev
    environment:
      - APP_API_DOMAIN=http://localhost:8000
    volumes:
      - ./:/api
    ports:
      - 8000:8000

  rdb:
    image: mariadb
    environment:
      - MYSQL_DATABASE=app
      - MYSQL_USER=app
      - MYSQL_PASSWORD=app
      - MYSQL_ALLOW_EMPTY_PASSWORD=yes
    volumes:
      - rdb:/var/lib/mysql

  rdbadmin:
    image: phpmyadmin/phpmyadmin
    environment:
      - PMA_HOST=rdb
      - PMA_port=3306
    ports:
      - 8080:80

  nrdb:
    image: mongo
    environment:
      - MONGO_INITDB_ROOT_USERNAME=app
      - MONGO_INITDB_ROOT_PASSWORD=app
    volumes:
      - nrdb:/var/lib/mongodb

  nrdbadmin:
    image: mongo-express
    ports:
      - 8081:8081
    environment:
      - ME_CONFIG_MONGODB_ADMINUSERNAME=app
      - ME_CONFIG_MONGODB_ADMINPASSWORD=app
      - ME_CONFIG_MONGODB_SERVER=nrdb
    depends_on:
      - nrdb

  node:
    image: qbitartifacts/crea-node
    volumes:
      - blockchain:/root/.creativecoin
