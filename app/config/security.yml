security:
    encoders:
        FOS\UserBundle\Model\UserInterface: sha512

    role_hierarchy:
        ROLE_ADMIN:           ROLE_USER
        ROLE_SUPER_ADMIN:     ROLE_ADMIN

    providers:
        by_access_key:
            id: access_key.security.user_provider

    firewalls:

        oauth_token:
            pattern:        ^/oauth/v2/token
            security:       false

        oauth_authorize:
            pattern:        ^/oauth/v2/auth
            form_login:
                check_path: fos_user_security_check
                login_path: fos_user_security_login
            anonymous: true

        #services_sandbox:
        #    pattern:    ^/sandbox/services
        #    fos_oauth:  true
        #    stateless:  true
        #    anonymous:  false
        #    context:    panel

        services:
            pattern: ^/services
            stateless: true
            fos_oauth:  true
            signature_auth: true

        #services_test:
        #    pattern: ^/test/services
        #    stateless: true
        #    signature_auth: true

        notifications:
            pattern:    ^/notifications
            stateless:  true
            security:   false

        #notifications_test:
        #    pattern:    ^/test/notifications
        #    stateless:  true
        #    security:   false

        oauth:
            pattern:    ^/
            fos_oauth:  true
            stateless:  true
            anonymous:  false
            context:    panel

        default:
            anonymous: ~

    access_control:
        - { path: ^/admin/v[0-9]+/*, role: ROLE_SUPER_ADMIN }
        - { path: ^/manager/v[0-9]+/*, role: ROLE_ADMIN }
        - { path: ^/user/v[0-9]+/*, role: ROLE_USER }
        - { path: ^/services/v[0-9]+/*, role: ROLE_USER }


